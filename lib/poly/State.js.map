{"version":3,"sources":["../../src/poly/State.js"],"names":["BLEND","DEPTH_TEST","FRONT_FACE","CULL_FACE","BLEND_FUNC","State","gl","activeState","Uint8Array","defaultState","data","blendMode","blendModes","source","alpha","SRC_ALPHA","dest","one","ONE","state","console","log","setBlend","setDepthTest","setFrontFace","setCullFace","setBlendMode","value","blendFunc","frontFace","CULLING"],"mappings":"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","file":"State.js","sourcesContent":["// inspired (copied) by (from) https://github.com/pixijs/pixi.js/blob/dev/src/core/renderers/webgl/WebGLState.js\nconst BLEND = 0;\nconst DEPTH_TEST = 1;\nconst FRONT_FACE = 2;\nconst CULL_FACE = 3;\nconst BLEND_FUNC = 4;\n\nexport default class State\n{\n    constructor(gl)\n    {\n        this.gl = gl;\n        this.activeState = new Uint8Array(16);\n        this.defaultState = new Uint8Array(16);\n        // this.activeState[BLEND] = 1;\n\n        this.data = 0;\n        // this.blend = true;\n        this.blendMode = 0;\n\n        this.blendModes = {\n            source: {\n                alpha: this.gl.SRC_ALPHA\n            },\n            dest: {\n                one: this.gl.ONE\n            },\n        }\n    }\n\n    get blend()\n    {\n        return this.activeState[BLEND];\n    }\n\n    set blend(value) // eslint-disable-line require-jsdoc\n    {\n        this.activeState[BLEND] = value;\n    }\n\n    get culling()\n    {\n        return this.activeState[CULLING];\n    }\n\n    set culling(value) // eslint-disable-line require-jsdoc\n    {\n        this.activeState[CULLING] = value;\n    }\n\n    get depthTest()\n    {\n        return this.activeState[DEPTH_TEST];\n    }\n\n    set depthTest(value) // eslint-disable-line require-jsdoc\n    {\n        this.activeState[DEPTH_TEST] = value;\n    }\n\n    get clockwiseFrontFace()\n    {\n        return this.activeState[FRONT_FACE];\n    }\n\n    set clockwiseFrontFace(value) // eslint-disable-line require-jsdoc\n    {\n        this.activeState[FRONT_FACE] = value;\n    }\n\n    get blendMode()\n    {\n        return this.activeState[BLEND_FUNC];\n        // return this._blendMode;\n    }\n\n    set blendMode(value) // eslint-disable-line require-jsdoc\n    {\n        this.activeState[BLEND_FUNC] = value;\n        // 17 is NO BLEND\n        // this.blend = (value !== 17);\n        // this._blendMode = value;\n    }\n\n    setState(state)\n    {\n        console.log('here');\n        this.setBlend(state.activeState[BLEND]);\n        this.setDepthTest(state.activeState[DEPTH_TEST]);\n        this.setFrontFace(state.activeState[FRONT_FACE]);\n        this.setCullFace(state.activeState[CULL_FACE]);\n        this.setBlendMode(state.activeState[BLEND_FUNC]);\n    }\n\n    setBlend(value)\n    {\n        value = value ? 1 : 0;\n\n        if (this.activeState[BLEND] === value)\n        {\n            return;\n        }\n        console.log(\"BLEND\");\n\n        this.activeState[BLEND] = value;\n        this.gl[value ? 'enable' : 'disable'](this.gl.BLEND);\n        // this.setDepthTest(!value); // no need to do that because ew blend before we depth test (right?)\n    }\n\n    setBlendMode(value, source = \"alpha\", dest = \"one\")\n    {\n        if (value === this.activeState[BLEND_FUNC])\n        {\n            return;\n        }\n\n        console.log('BLENDMODE');\n        this.activeState[BLEND_FUNC] = value;\n\n        this.gl.blendFunc(this.blendModes.source[source], this.blendModes.dest[dest]);\n        //\n        // const mode = this.blendModes[value];\n        //\n        // if (mode.length === 2)\n        // {\n        //     this.gl.blendFunc(mode[0], mode[1]);\n        // }\n        // else\n        // {\n        //     this.gl.blendFuncSeparate(mode[0], mode[1], mode[2], mode[3]);\n        // }\n    }\n\n    setDepthTest(value)\n    {\n        value = value ? 1 : 0;\n        if (this.activeState[DEPTH_TEST] === value)\n        {\n            return;\n        }\n        console.log(\"DEPTHTEST\");\n\n        this.activeState[DEPTH_TEST] = value;\n        this.gl[value ? 'enable' : 'disable'](this.gl.DEPTH_TEST);\n    }\n\n    setCullFace(value)\n    {\n        value = value ? 1 : 0;\n\n        if (this.activeState[CULL_FACE] === value)\n        {\n            return;\n        }\n\n        this.activeState[CULL_FACE] = value;\n        this.gl[value ? 'enable' : 'disable'](this.gl.CULL_FACE);\n    }\n\n    setFrontFace(value)\n    {\n        value = value ? 1 : 0;\n\n        if (this.activeState[FRONT_FACE] === value)\n        {\n            return;\n        }\n\n        this.activeState[FRONT_FACE] = value;\n        this.gl.frontFace(this.gl[value ? 'CW' : 'CCW']);\n    }\n}\n"]}